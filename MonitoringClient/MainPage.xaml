<UserControl xmlns:my1="clr-namespace:MonitoringClient"  x:Class="MonitoringClient.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    d:DesignHeight="500" d:DesignWidth="800" xmlns:sdk="http://schemas.microsoft.com/winfx/2006/xaml/presentation/sdk" xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit" xmlns:my="clr-namespace:MonitoringClient.ActivityMonitoringServiceReference" xmlns:src="clr-namespace:MonitoringClient.Converters" Loaded="UserControl_Loaded">
    <UserControl.Resources>
        <CollectionViewSource x:Key="briefUserStatsViewSource" d:DesignSource="{d:DesignInstance my:BriefUserStats, CreateList=True}" />
        <src:TimeSpanConverter x:Key="timeSpanConverter" />
        <src:BriefUserStatsCurrentWorksConverter x:Key="BriefUserStatsCurrentWorksConverter" />
        <src:LocalDateTimeConverter x:Key="LocalDateTimeConverter" />
    </UserControl.Resources>
    <ScrollViewer>
        <Grid x:Name="LayoutRoot" Background="White">
            <toolkit:BusyIndicator Name="dataGrid1Busy" BusyContent="Please wait...">
                <StackPanel>
                    <toolkit:Expander IsExpanded="True" x:Name="ExpanderBrief">
                        <toolkit:Expander.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <TextBlock Text="Brief Stats" Style="{StaticResource Title2TextNoMargin}"/>
                                    <TextBlock HorizontalAlignment="Right" Text="{Binding Path=Tag, ElementName=ExpanderBrief}" />
                                </Grid>
                            </DataTemplate>
                        </toolkit:Expander.HeaderTemplate>
                        <Grid x:Name="BriefMainGrid" Background="White">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="300" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0"  Grid.Row="0" >
                                <sdk:DataGrid AutoGenerateColumns="False" Name="BriefStatsGrid" DataContext="{Binding}" ItemsSource="{Binding Source={StaticResource briefUserStatsViewSource}}" IsReadOnly="True" SelectionMode="Single" SelectionChanged="BriefStatsGrid_SelectionChanged">
                                    <sdk:DataGrid.Columns>
                                        <sdk:DataGridTemplateColumn Header="Details">
                                            <sdk:DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox Tag="{Binding}" Checked="DetailsCheckBox_Checked" Unchecked="DetailsCheckBox_Unchecked" VerticalAlignment="Center" HorizontalAlignment="Center" IsChecked="{Binding Path=IsSelectedForDetails, Mode=TwoWay}" />
                                                </DataTemplate>
                                            </sdk:DataGridTemplateColumn.CellTemplate>
                                        </sdk:DataGridTemplateColumn>
                                        <!--<sdk:DataGridCheckBoxColumn Binding="{Binding Path=IsSelectedForDetails}" Header="x" />-->
                                        <sdk:DataGridTextColumn Binding="{Binding Path=UserId}" Header="UserId" Visibility="Collapsed" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=UserName}" Header="UserName" Width="140" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=Status}" Header="Status" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=CurrentWorkString}" CanUserReorder="True" CanUserResize="True" CanUserSort="True" Width="210" Header="CurrentWork" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=TodaysWorkTime.NetWorkTime, Converter={StaticResource timeSpanConverter},ConverterParameter=HH:mm:ss}" Header="Today" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=TodaysStartDate, StringFormat=t, Converter={StaticResource LocalDateTimeConverter}}" Header="StartDate" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=TodaysEndDate, StringFormat='t', Converter={StaticResource LocalDateTimeConverter}}" Header="EndDate" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=ThisWeeksWorkTime.NetWorkTime, Converter={StaticResource timeSpanConverter},ConverterParameter=HH:mm}" Header="ThisWeek" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=ThisMonthsWorkTime.NetWorkTime, Converter={StaticResource timeSpanConverter},ConverterParameter=HH:mm}" Header="ThisMonth" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=ThisWeeksTargetUntilTodayNetWorkTime, Converter={StaticResource timeSpanConverter}, ConverterParameter=HH:mm}" Header="WeekTargetNow" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=ThisMonthsTargetUntilTodayNetWorkTime, Converter={StaticResource timeSpanConverter},ConverterParameter=HH:mm}" Header="MonthTargetNow" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=ThisWeeksTargetNetWorkTime, Converter={StaticResource timeSpanConverter},ConverterParameter=HH:mm}" Header="WeekTarget" />
                                        <sdk:DataGridTextColumn Binding="{Binding Path=ThisMonthsTargetNetWorkTime, Converter={StaticResource timeSpanConverter},ConverterParameter=HH:mm}" Header="MonthTarget" />
                                        <sdk:DataGridCheckBoxColumn Binding="{Binding Path=HasComputerActivity}" Header="Activity" />
                                        <sdk:DataGridCheckBoxColumn Binding="{Binding Path=HasRemoteDesktop}" Header="Remote" />
                                        <sdk:DataGridCheckBoxColumn Binding="{Binding Path=HasVirtualMachine}" Header="Virtual" />
                                        <sdk:DataGridTemplateColumn Header="Kick Computer">
                                            <sdk:DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ItemsControl ItemsSource="{Binding Path=OnlineComputers}" Tag="{Binding Path=UserId}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <StackPanel Orientation="Horizontal"  />
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <Button Click="KickButton_Click" Tag="{Binding Path='.'}">
                                                                    <TextBlock Text="{Binding Path='.', StringFormat='Kick {0}'}"></TextBlock>
                                                                </Button>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </DataTemplate>
                                            </sdk:DataGridTemplateColumn.CellTemplate>
                                        </sdk:DataGridTemplateColumn>
                                        <sdk:DataGridTemplateColumn Header="IP Addresses">
                                            <sdk:DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <ItemsControl ItemsSource="{Binding Path=IPAddresses}">
                                                        <ItemsControl.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" />
                                                            </ItemsPanelTemplate>
                                                        </ItemsControl.ItemsPanel>
                                                        <ItemsControl.ItemTemplate>
                                                            <DataTemplate>
                                                                <TextBlock Text="{Binding Path='.'}" Margin="0,0,5,0"></TextBlock>
                                                            </DataTemplate>
                                                        </ItemsControl.ItemTemplate>
                                                    </ItemsControl>
                                                </DataTemplate>
                                            </sdk:DataGridTemplateColumn.CellTemplate>
                                        </sdk:DataGridTemplateColumn>
                                    </sdk:DataGrid.Columns>
                                </sdk:DataGrid>
                                <sdk:DataPager Name="BriefStatsPager" DisplayMode="PreviousNext" />
                            </StackPanel>
                            <StackPanel Grid.Column="1" Grid.Row="0" Margin="10,30,0,20">
                                <my1:BriefStatsDetailsView x:Name="BriefStatsDetailsView" Visibility="Collapsed"/>
                            </StackPanel>
                        </Grid>
                    </toolkit:Expander>
                    <toolkit:Expander IsExpanded="True" x:Name="ExpanderDetailed">
                        <toolkit:Expander.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <TextBlock Text="Detailed Stats" Style="{StaticResource Title2TextNoMargin}"/>
                                    <TextBlock HorizontalAlignment="Right" Text="{Binding Path=Tag, ElementName=ExpanderDetailed}" />
                                </Grid>
                            </DataTemplate>
                        </toolkit:Expander.HeaderTemplate>
                        <StackPanel>
                            <StackPanel Orientation="Horizontal">
                                <Button Width="40" HorizontalAlignment="Left" Click="TwoScreens_Click" Margin="5,0">2</Button>
                                <Button Width="40" HorizontalAlignment="Left" Click="ThreeScreens_Click" Margin="5,0">3</Button>
                                <Button Width="40" HorizontalAlignment="Left" Click="FourScreens_Click" Margin="5,0">4</Button>
                                <Button Width="40" HorizontalAlignment="Left" Click="FiveScreens_Click" Margin="5,0">5</Button>
                                <Button Width="80" HorizontalAlignment="Left" Click="FullScreen_Click" Margin="80,0,0,0">Full Screen</Button>
                                <CheckBox Content="Show Activities" Height="16" Margin="15,0" IsChecked="True" Name="cbActivities" Checked="cbActivities_Checked" Unchecked="cbActivities_Unchecked" />
                            </StackPanel>
                            <toolkit:WrapPanel x:Name="DetailsPanel" />
                        </StackPanel>
                    </toolkit:Expander>
                    <TextBlock><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/><LineBreak/></TextBlock>
                </StackPanel>
            </toolkit:BusyIndicator>
        </Grid>
    </ScrollViewer>
</UserControl>
