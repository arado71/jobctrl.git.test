<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" Condition="Exists('$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props')" />
  <!--
    This section defines project-level properties.

    AssemblyName
      Name of the output assembly.
    Configuration
      Specifies a default value for debug.
    OutputType
      Must be "Library" for VSTO.
    Platform
      Specifies what CPU the output of this project can run on.
    NoStandardLibraries
      Set to "false" for VSTO.
    RootNamespace
      In C#, this specifies the namespace given to new files. In VB, all objects are
      wrapped in this namespace at runtime.
  -->
  <PropertyGroup>
    <ProjectTypeGuids>{BAA0C2D2-18E2-41B9-852F-F413020CAA33};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">MixedWix</Platform>
    <ProjectGuid>{1FB95233-BA3D-4C1A-9868-79980A8344D9}</ProjectGuid>
    <OutputType>Library</OutputType>
    <NoStandardLibraries>false</NoStandardLibraries>
    <RootNamespace>MailActivityTracker</RootNamespace>
    <AssemblyName>MailActivityTracker</AssemblyName>
    <TargetFrameworkVersion>v4.5</TargetFrameworkVersion>
    <DefineConstants>VSTO40</DefineConstants>
    <IsWebBootstrapper>False</IsWebBootstrapper>
    <FileUpgradeFlags>
    </FileUpgradeFlags>
    <UpgradeBackupLocation>
    </UpgradeBackupLocation>
    <OldToolsVersion>12.0</OldToolsVersion>
    <VSTO_TrustAssembliesLocation>true</VSTO_TrustAssembliesLocation>
    <BootstrapperEnabled>true</BootstrapperEnabled>
    <PublishUrl>publish\</PublishUrl>
    <InstallUrl />
    <TargetCulture>en</TargetCulture>
    <ApplicationVersion>1.0.1.0</ApplicationVersion>
    <AutoIncrementApplicationRevision>true</AutoIncrementApplicationRevision>
    <UpdateEnabled>true</UpdateEnabled>
    <UpdateInterval>7</UpdateInterval>
    <UpdateIntervalUnits>days</UpdateIntervalUnits>
    <ProductName>MailActivityTracker</ProductName>
    <PublisherName />
    <SupportUrl />
    <FriendlyName>MailActivityTracker</FriendlyName>
    <OfficeApplicationDescription />
    <LoadBehavior>3</LoadBehavior>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Platform)' == 'MixedCo' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Platform)' == 'MixedWix' ">
    <PlatformTarget>AnyCPU</PlatformTarget>
  </PropertyGroup>
  <ItemGroup>
    <BootstrapperPackage Include=".NETFramework,Version=v4.0">
      <Visible>False</Visible>
      <ProductName>Microsoft .NET Framework 4 %28x86 and x64%29</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Client.3.5">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1 Client Profile</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Framework.3.5.SP1">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Office.PIARedist.2007">
      <Visible>False</Visible>
      <ProductName>Microsoft Office 2007 Primary Interop Assemblies</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.VSTORuntime.4.0">
      <Visible>False</Visible>
      <ProductName>Microsoft Visual Studio 2010 Tools for Office Runtime %28x86 and x64%29</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Windows.Installer.3.1">
      <Visible>False</Visible>
      <ProductName>Windows Installer 3.1</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Windows.Installer.4.5">
      <Visible>False</Visible>
      <ProductName>Windows Installer 4.5</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
  </ItemGroup>
  <PropertyGroup>
    <!--
      OfficeApplication
        Add-in host application
    -->
    <OfficeApplication>Outlook</OfficeApplication>
  </PropertyGroup>
  <!--
    This section specifies references for the project.
  -->
  <ItemGroup>
    <Reference Include="Accessibility" />
    <Reference Include="Interop.UIAutomationClient, Version=12.0.21213.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <EmbedInteropTypes>True</EmbedInteropTypes>
      <HintPath>dependencies\Interop.UIAutomationClient.dll</HintPath>
    </Reference>
    <Reference Include="log4net, Version=2.0.15.0, Culture=neutral, PublicKeyToken=669e0ddf0bb1aa2a, processorArchitecture=MSIL">
      <HintPath>..\..\packages\log4net.2.0.15\lib\net40\log4net.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Office.Core">
      <HintPath>dependencies\Microsoft.Office.Core.dll</HintPath>
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="Microsoft.Office.Interop.Outlook, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <EmbedInteropTypes>True</EmbedInteropTypes>
      <HintPath>dependencies\Microsoft.Office.Interop.Outlook.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Office.Interop.Word, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <EmbedInteropTypes>True</EmbedInteropTypes>
      <HintPath>dependencies\Microsoft.Office.Interop.Word.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Office.Tools, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="Microsoft.Office.Tools.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <EmbedInteropTypes>True</EmbedInteropTypes>
      <HintPath>dependencies\Microsoft.Office.Tools.Common.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.Office.Tools.Common.v4.0.Utilities, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>dependencies\Microsoft.Office.Tools.Common.v4.0.Utilities.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Office.Tools.Outlook, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <EmbedInteropTypes>True</EmbedInteropTypes>
    </Reference>
    <Reference Include="Microsoft.Office.Tools.Outlook.v4.0.Utilities, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>dependencies\Microsoft.Office.Tools.Outlook.v4.0.Utilities.dll</HintPath>
      <Private>True</Private>
    </Reference>
    <Reference Include="Microsoft.Office.Tools.v4.0.Framework, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL">
      <SpecificVersion>False</SpecificVersion>
      <HintPath>dependencies\Microsoft.Office.Tools.v4.0.Framework.dll</HintPath>
    </Reference>
    <Reference Include="Microsoft.VisualStudio.Tools.Applications.Runtime, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
    <Reference Include="System" />
    <Reference Include="System.configuration" />
    <Reference Include="System.Data" />
    <Reference Include="System.Drawing" />
    <Reference Include="System.Runtime.Serialization" />
    <Reference Include="System.ServiceModel" />
    <Reference Include="System.Web" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="UIAutomationClient" />
    <Reference Include="UIAutomationTypes" />
  </ItemGroup>
  <!--
    This section defines the user source files that are part of the project.
     
    A "Compile" element specifies a source file to compile.
    An "EmbeddedResource" element specifies an .resx file for embedded resources.
    A "None" element specifies a file that is not to be passed to the compiler (for instance, 
    a text file or XML file).
    The "AppDesigner" element specifies the directory where the application properties files
    can be found.
  -->
  <ItemGroup>
    <Compile Include="..\..\ActivityRecorderClient\Capturing.Desktop.Windows\AutomationHelper.cs">
      <Link>AutomationHelper.cs</Link>
    </Compile>
    <Compile Include="..\..\ActivityRecorderClient\Capturing.Mail\OutlookAddinInstallHelper.cs">
      <Link>OutlookAddinInstallHelper.cs</Link>
    </Compile>
    <Compile Include="IAddinMailCaptureService.cs" />
    <Compile Include="IOleWindow.cs" />
    <Compile Include="Labels.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Labels.resx</DependentUpon>
    </Compile>
    <Compile Include="Labels.hu-HU.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Labels.hu-HU.resx</DependentUpon>
    </Compile>
    <Compile Include="LocalizationHelper.cs" />
    <Compile Include="Model\CategoryData.cs" />
    <Compile Include="Model\ClientMenu.cs" />
    <Compile Include="Model\CompositeMapping.cs" />
    <Compile Include="Model\MeetingPluginTaskIdSettings.cs" />
    <Compile Include="Model\WorkData.cs" />
    <Compile Include="OleHandleHelper.cs" />
    <Compile Include="OutlookAddinMailCaptureService.cs" />
    <Compile Include="ProjectRibbon.cs">
      <SubType>Component</SubType>
    </Compile>
    <Compile Include="ProjectRibbon.Designer.cs">
      <DependentUpon>ProjectRibbon.cs</DependentUpon>
    </Compile>
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <Compile Include="WinApi.cs" />
    <EmbeddedResource Include="Labels.hu-HU.resx">
      <SubType>Designer</SubType>
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Labels.hu-HU.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <EmbeddedResource Include="Labels.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Labels.Designer.cs</LastGenOutput>
      <SubType>Designer</SubType>
    </EmbeddedResource>
    <EmbeddedResource Include="ProjectRibbon.resx">
      <DependentUpon>ProjectRibbon.cs</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <SubType>Designer</SubType>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <EmbeddedResource Include="TaskSelector.resx">
      <DependentUpon>TaskSelector.cs</DependentUpon>
    </EmbeddedResource>
    <None Include="App.config">
      <SubType>Designer</SubType>
    </None>
    <None Include="packages.config" />
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
      <DesignTimeSharedInput>True</DesignTimeSharedInput>
    </Compile>
    <Compile Include="TaskSelector.cs">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="TaskSelector.Designer.cs">
      <DependentUpon>TaskSelector.cs</DependentUpon>
    </Compile>
    <Compile Include="ThisAddIn.cs">
      <SubType>Code</SubType>
    </Compile>
    <None Include="..\..\Keys\tct_self.pfx" />
    <None Include="ThisAddIn.Designer.xml">
      <DependentUpon>ThisAddIn.cs</DependentUpon>
    </None>
    <Compile Include="ThisAddIn.Designer.cs">
      <DependentUpon>ThisAddIn.Designer.xml</DependentUpon>
    </Compile>
    <AppDesigner Include="Properties\" />
  </ItemGroup>
  <ItemGroup>
    <WCFMetadata Include="Service References\" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Resources\app_icon.png" />
  </ItemGroup>
  <ItemGroup>
    <ProjectReference Include="..\..\OutlookInterop\OutlookInteropService\OutlookInteropService.csproj">
      <Project>{5308dd77-3c75-4d0b-b1f5-b725dc1bc273}</Project>
      <Name>OutlookInteropService</Name>
    </ProjectReference>
  </ItemGroup>
  <PropertyGroup>
    <VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">10.0</VisualStudioVersion>
    <VSToolsPath Condition="'$(VSToolsPath)' == ''">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)</VSToolsPath>
    <VSToolsPath Condition="!Exists('$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)')">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v17.0</VSToolsPath>
  </PropertyGroup>
  <PropertyGroup>
    <SignManifests>true</SignManifests>
  </PropertyGroup>
  <PropertyGroup>
    <ManifestKeyFile>..\..\Keys\tct_self.pfx</ManifestKeyFile>
  </PropertyGroup>
  <PropertyGroup>
    <ManifestCertificateThumbprint>A797B1DE26092BF218A89C633DE5C14315F7755D</ManifestCertificateThumbprint>
  </PropertyGroup>
  <PropertyGroup>
    <SignAssembly>false</SignAssembly>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Debug|MixedWix'">
    <UseVSHostingProcess>true</UseVSHostingProcess>
  </PropertyGroup>
  <!-- Include the build rules for a C# project. -->
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
  <!-- Include additional build rules for an Office application add-in. -->
  <Import Project="$(VSToolsPath)\OfficeTools\Microsoft.VisualStudio.Tools.Office.targets" Condition="'$(VSToolsPath)' != ''" />
  <!-- This section defines VSTO properties that describe the host-changeable project properties. -->
  <ProjectExtensions>
    <VisualStudio>
      <FlavorProperties GUID="{BAA0C2D2-18E2-41B9-852F-F413020CAA33}">
        <ProjectProperties HostName="Outlook" HostPackage="{29A7B9D7-A7F1-4328-8EF0-6B2D1A56B2C1}" OfficeVersion="15.0" VstxVersion="4.0" ApplicationType="Outlook" Language="cs" TemplatesPath="VSTOTemplates" DebugInfoExeName="#Software\Microsoft\Office\16.0\Outlook\InstallRoot\Path#outlook.exe" AddItemTemplatesGuid="{A58A78EB-1C92-4DDD-80CF-E8BD872ABFC4}" />
        <Host Name="Outlook" GeneratedCodeNamespace="MailActivityTracker" IconIndex="0">
          <HostItem Name="ThisAddIn" Code="ThisAddIn.cs" CanonicalName="AddIn" CanActivate="false" IconIndex="1" Blueprint="ThisAddIn.Designer.xml" GeneratedCode="ThisAddIn.Designer.cs" />
        </Host>
      </FlavorProperties>
    </VisualStudio>
  </ProjectExtensions>
  <PropertyGroup>
    <PostBuildEvent>if not exist "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\hu-HU\" (mkdir "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\hu-HU\")
for /f "delims=" %25%25a in ('dir /b/s "c:\Program Files (x86)\Windows Kits\signtool.exe"') do set SIGNTOOL="%25%25a"
set MAGECMD="$(ProjectDir)..\..\Utilities\mage_etoken.exe"
if $(ConfigurationName) == Release (
  pushd "$(TargetDir)"
  if not "%25TOKENSIGN%25" == "" (
    %25SIGNTOOL%25 sign /f "$(ProjectDir)..\..\Keys\TcT_CS_Public.cer" /csp "eToken Base Cryptographic Provider" /k "[{{Jobctrl789$}}]=Sectigo_20231010110831" /sha1 b4544a03a6db2afdc89225e10c08a6d19c32e457 /fd sha256 /tr http://rfc3161timestamp.globalsign.com/advanced /td sha256 /as MailActivityTracker.dll || exit /b 255
    %25MAGECMD%25 -update MailActivityTracker.dll.manifest -cf "$(ProjectDir)..\..\Keys\TcT_CS_Public.cer" -csp "eToken Base Cryptographic Provider" -kc "[{{Jobctrl789$}}]=Sectigo_20231010110831" -a sha256RSA -ti "http://timestamp.globalsign.com/?signature=sha2" || exit /b 255
    %25MAGECMD%25 -update MailActivityTracker.vsto -appmanifest MailActivityTracker.dll.manifest -cf "$(ProjectDir)..\..\Keys\TcT_CS_Public.cer" -csp "eToken Base Cryptographic Provider" -kc "[{{Jobctrl789$}}]=Sectigo_20231010110831" -a sha256RSA -ti "http://timestamp.globalsign.com/?signature=sha2" || exit /b 255
  )
  if "%25TOKENSIGN%25" == "" (
    %25SIGNTOOL%25 sign /f "$(ProjectDir)..\..\Keys\tct_self.pfx" /p jobctrl789 /sha1 A797B1DE26092BF218A89C633DE5C14315F7755D /fd sha256 /tr http://rfc3161timestamp.globalsign.com/advanced /td sha256 /as MailActivityTracker.dll || exit /b 255
    %25MAGECMD%25 -update MailActivityTracker.dll.manifest -certfile "$(ProjectDir)..\..\Keys\tct_self.pfx" -password jobctrl789 -a sha256RSA -ti "http://timestamp.globalsign.com/?signature=sha2" || exit /b 255
    %25MAGECMD%25 -update MailActivityTracker.vsto -appmanifest MailActivityTracker.dll.manifest -certfile "$(ProjectDir)..\..\Keys\tct_self.pfx" -password jobctrl789 -a sha256RSA -ti "http://timestamp.globalsign.com/?signature=sha2" || exit /b 255
  )
  popd
)
copy "$(TargetDir)\MailActivityTracker.vsto" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\" || exit /b 255
copy "$(TargetDir)\MailActivityTracker.dll.manifest" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\" || exit /b 255
copy "$(TargetDir)\MailActivityTracker.dll" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\" || exit /b 255
copy "$(TargetDir)\MailActivityTracker.dll.config" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\" || exit /b 255
copy "$(TargetDir)\OutlookInteropService.dll" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\" || exit /b 255
copy "$(TargetDir)\hu-HU\MailActivityTracker.resources.dll" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\hu-HU\" || exit /b 255
copy "$(ProjectDir)\dependencies\Microsoft.Office.Tools.Common.v4.0.Utilities.dll" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\" || exit /b 255
copy "$(ProjectDir)\dependencies\Microsoft.Office.Tools.Outlook.v4.0.Utilities.dll" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\" || exit /b 255
copy "$(TargetDir)\Microsoft.Office.Tools.v4.0.Framework.dll" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\" || exit /b 255
copy "$(TargetDir)\log4net.dll" "$(ProjectDir)..\..\ActivityRecorderClient\OutlookAddin\" || exit /b 255
	</PostBuildEvent>
  </PropertyGroup>
</Project>